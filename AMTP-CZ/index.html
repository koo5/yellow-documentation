<!DOCTYPE html>
<html lang="cs">
<head>
 <title>Advanced Mail Transfer Protocol (AMTP) - dokumentace</title>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <link rel="stylesheet" href="style.css" type="text/css" />
 <script src="js/toc.js"></script>
 <script src="js/main.js"></script>
 </head>
 <body>
  <div id="header" class="no-print">
   <a id="menu" onclick="menu()">☰</a>
   <a id="logo" href="#top">AMTP - dokumentace</a>
  </div>
  <div id="toc" class="no-print"></div>
  <div id="doc">
   <a name="top"></a><h1 class="center">Advanced Mail Transfer Protocol (AMTP) - dokumentace</h1>
   <div class="center">
    <div><span class="bold center">UPOZORNĚNÍ:</span><br /><span>Toto je pouze návrh, nejedná se o konečnou verzi protokolu.</span></div>
    <div><span class="bold">Verze návrhu: </span><span>1</span></div>
    <div><span class="bold">Vydáno: </span><span>Květen 2024</span></div>
   </div>
   <a name="about"></a><h2>Úvod</h2>
   <div><span class="bold">Advanced Mail Transfer Protocol (AMTP)</span> je nová generace síťového protokolu elektronické pošty (e-mailu), která překračuje omezení tradičních protokolů <a href="https://cs.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol" target="_blank">SMTP</a>, <a href="https://cs.wikipedia.org/wiki/Post_Office_Protocol" target="_blank">POP</a> a <a href="https://cs.wikipedia.org/wiki/Internet_Message_Access_Protocol" target="_blank">IMAP</a> využitím nových technologií, modulární koncepce a pokročilých způsobů zabezpečení. Plně tyto protokoly nahrazuje svou funkcionalitou (mimo zasílání zpráv, které je popsáno v samostatném modulu) a významně rožšiřuje jejich použitelnost díky svému modulárnímu konceptu. Zároveň používá modernější, bezpečnější metody přenosu dat v reálném čase.</div>
   <a name="subject"></a><h2>Předmět dokumentace</h2>
   <div class="bold">Tento dokument popisuje:</div>
   <ul>
    <li><span class="bold">Síťový protokol</span>: vysvětluje způsoby, kterými jsou data přenášena, formátována, přeposílána a zabezpečena.</li>
   </ul>
   <div class="bold">Tento dokument nepopisuje:</div>
   <ul>
    <li><span class="bold">Implementaci</span>: specifikaci software serverové a klientské aplikace - např. způsoby ukládání a zpracování dat</li>
    <li><span class="bold">Moduly</span>: specifikaci jednotlivých serverových a klientských modulů - např. zasílání zpráv, diskuze, funkce sociálních médií apod. - moduly jsou popsány v samostatných dokumentech</li>
   </ul>
   <a name="arguments"></a><h2>Důvody vytvoření</h2>
   <div>Vzhledem k tomu, že tradiční e-mailové protokoly <span class="bold">SMTP</span>, <span class="bold">POP</span> a <span class="bold">IMAP</span> byly poprvé vyvinuty v 80. letech minulého století, vznikly po čase potřeby, které tyto protokoly již nejsou schopny efektivně řešit kvůli svému stáří a omezené funkcionalitě.</div>
   <div>Konkrétní roky vytvoření dokumentace a posledních aktualizací původních e-mailových protokolů:</div>
   <div class="bold">SMTP:</div>
   <ul>
    <li>První dokumentace: <a href="https://www.rfc-editor.org/rfc/rfc821.html" target="_blank">RFC 821</a> (1982)</li>
    <li>Poslední aktualizace: <a href="https://www.rfc-editor.org/rfc/rfc5321.html" target="_blank">RFC 5321</a> (2008)</li>
   </ul>
   <div class="bold">POP:</div>
   <ul>
    <li>První dokumentace: <a href="https://www.rfc-editor.org/rfc/rfc918.html" target="_blank">RFC 918</a> (1984)</li>
    <li>Poslední aktualizace: <a href="https://www.rfc-editor.org/rfc/rfc1939.html" target="_blank">RFC 1939</a> (1996)</li>
   </ul>
   <div class="bold">IMAP:</div>
   <ul>
    <li>První dokumentace: <a href="https://www.rfc-editor.org/rfc/rfc1064.html" target="_blank">RFC 1064</a> (1988)</li>
    <li>Poslední aktualizace: <a href="https://www.rfc-editor.org/rfc/rfc9051.html" target="_blank">RFC 9051</a> (2021)</li>
   </ul>
   <div>I přesto, že byly tyto protokoly v průběhu času aktualizovány, stále nepřinášejí dostatečná řešení pro nové potřeby, jako jsou komunikace v reálném čase, komplexní zabezpečení, strukturovanou komunikaci, snadnou rozšiřitelnost funkcionalit a mnoho dalšího. To je způsobeno především snahou těchto aktualizací o navázání na původní koncepty, což je velmi limitující faktor, který vyžaduje změnu přístupu.</div>
   <div>Protokol <span class="bold">AMTP</span> nenavazuje na původní zastaralé koncepty a místo toho přináší nové, moderní přístupy k řešení těchto potřeb.</div>
   <div>Ačkoliv jsou veřejně dostupné i další otevřené protokoly či platformy (např. <a href="https://cs.wikipedia.org/wiki/Matrix_(protokol)" target="_blank">Matrix</a>, <a href="https://cs.wikipedia.org/wiki/Mastodon_(software)" target="_blank">Mastodon</a>, <a href="https://cs.wikipedia.org/wiki/Diaspora*_(soci%C3%A1ln%C3%AD_s%C3%AD%C5%A5)" target="_blank">Diaspora</a>, <a href="https://en.wikipedia.org/wiki/Nostr" target="_blank">Nostr</a> apod.), které umožňují bezpečnou komunikaci a nabízí decentralizovanou či distribuovanou síť, ke které se může kdokoliv připojit, stále nenabízí některé důležité funkcionality, které <span class="bold">AMTP</span> řeší, jako například modulární koncept funkcionalit nebo podporu nejnovějších komunikačních protokolů pro přenos dat v reálném čase.</div>
   <a name="objectives"></a><h2>Cíle protokolu</h2>
   <div>Cílem vytvoření tohoto protokolu je nahrazení současných e-mailových protokolů <span class="bold">SMTP</span>, <span class="bold">POP</span> a <span class="bold">IMAP</span> pomocí nové, moderní a bezpečné alternativy, která taktéž přináší snadnou rozšiřitelnost funkcionalit díky modulárnímu konceptu, čímž je zajištěna dlouhá životnost a udržitelnost implementací tohoto protokolu. Funkcionalita všech původních e-mailových protokolů je v <span class="bold">AMTP</span> plně zachována a navíc značně rozšířena a zmodernizována.</div>
   <div><span class="bold">Zpětná kompatibilita</span> s původními e-mailovými protokoly není implementována v rámci tohoto protokolu, jelikož jí lze zajistit pomocí modulu na serveru, který komunikuje se <span class="bold">SMTP</span> serverem nebo implementací <span class="bold">IMAP</span> protokolu v rámci klientské aplikace. Těmito implementacemi lze zajistit hladký přechod pro poskytovatele e-mailových služeb ze serverů používajících původní e-mailové standardy na moderní implementace <span class="bold">AMTP</span>.</div>
   <div class="bold">Zachované koncepty v AMTP z původního SMTP:</div>
   <ul class="spacelist">
    <li><span class="bold">Distribuovaná síť</span>: Typ sítě, ve které je komunikace, zpracování a ukládání dat distribuováno mezi mnoho uzlů, které mohou mít různé vlastníky (poskytovatele služby). Tyto uzly mohou mezi sebou navzájem komunikovat, předávat si data a odlišovat se mezi sebou dle pravidel a sad služeb, které poskytují svým uživatelům. To síť odlišuje jak od centralistického modelu, kde je síť řízena jediným poskytovatelem, tak i od plně decentralizovaného modelu, kde každý koncový uživatel je suverénní jednotkou, která komunikuje s ostatními v rámci peer-to-peer sítě.</li>
    <li><span class="bold">Identita e-mailové adresy</span>: Formát adresy uživatelského účtu je zachován (s menšími odlišnostmi, popsanými v dalších částech této dokumentace) z původních e-mailových standardů. Ve zjednodušené formě je to formát <span class="bold">uživatel@doména</span>.</li>
   </ul>
   <div class="bold">Nové koncepty v AMTP:</div>
   <ul class="spacelist">
    <li><span class="bold">Komunikace v reálném čase</span>: Tento přístup, díky technologiím jako je <a href="https://www.w3.org/TR/webtransport/" target="_blank">WebTransport</a>, umožňuje uživatelům pohodlněji vést konverzace, rychleji reagovat na zprávy a využívat řadu dalších funkcionalit, kde je okamžitá komunikace nezbytná (např. videohovory, sdílení obrazovky, přenos velkých souborů apod.) a to navíc paralelně díky vícekanálové komunikaci. Tím jsou sníženy latence a zvýšena propustnost při přenosu dat.</li>
    <li><span class="bold">Bezpečná komunikace</span>: Protokol klade velký důraz na zabezpečenou komunikaci a tím chrání soukromí uživatelů na více vrstvách. Díky tomu jsou minimalizována rizika spojená s únikem dat, znemožněny odposlechy a další formy kybernetických útoků.</li>
    <li><span class="bold">Rozšiřitelnost</span>: Protokol umožňuje snadno vytvářet rožšíření o různé funkcionality díky modulárnímu konceptu, ať už jde o vytváření jednoduchých jednoúčelových aplikací (např. zasílání zpráv z <a href="https://cs.wikipedia.org/wiki/Internet_v%C4%9Bc%C3%AD" target="_blank">IoT zařízení</a> uživateli) až po multifunkční <a href="https://en.wikipedia.org/wiki/Super-app" target="_blank">super-aplikace</a> s četnou řadou funkcionalit (např. zasílání rychlých zpráv, funkce sociálních médií, e-commerce, přenosy velkých souborů, přenos dat v online hrách apod.).</li>
    <li><span class="bold">Strukturovaná data</span>: Přenášená data jsou sestavena strukturovaně ve formátu <a href="https://en.wikipedia.org/wiki/BSON" target="_blank">BSON</a>, který kombinuje výhody strojově i lidsky snadno čitelného formátu <a href="https://cs.wikipedia.org/wiki/JSON" target="_blank">JSON</a>, s efektivitou binárního formátu. To umožňuje, aby data byla snadno přístupná a zpracovatelná jak pro vývojáře, tak pro aplikace.</li>
   </ul>
   <a name="standards"></a><h2>Zvolené standardy</h2>
   <div>Při výběru standardů pro protokol <span class="bold">AMTP</span> byl kladen důraz na několik klíčových aspektů, které byly rozhodující pro zajištění, že nově vyvinutý protokol bude splňovat všechny potřeby moderní elektronické komunikace. Mezi tato hlavní kritéria, která ovlivnila výběr technologií patří:</div>
   <ul class="spacelist">
    <li><span class="bold">Výkon a efektivita</span>: Standardy byly vybírány s ohledem na jejich schopnost zpracovávat velké objemy dat s minimálními zpožděními. Je důležité, aby protokol dokázal efektivně zpracovávat data a zároveň zajišťovat rychlý přenos informací mezi uživateli.</li>
    <li><span class="bold">Bezpečnost a ochrana soukromí</span>: Zabezpečení je jedním z nejdůležitějších aspektů většiny komunikačních protokolů, zvláště v době kybernetických hrozeb. Standardy musí poskytovat robustní zabezpečení na úrovni přenosu dat a zároveň nabízet mechanismy pro ochranu soukromí uživatelů.</li>
    <li><span class="bold">Kompatibilita</span>: Standardy byly vybrány také s ohledem na jejich úplnou podporu a dostupnost pro snadnou tvorbu klientských i serverových aplikací.</li>
    <li><span class="bold">Otevřenost</span>: Je klíčové, aby standardy byly založeny na otevřených specifikacích, které jsou veřejně dostupné a bez patentových omezení. Stejně tak samotný <span class="bold">AMTP</span> je otevřeným protokolem.</li>
    <li><span class="bold">Inovace</span>: Standardy mají představovat velmi inovativní komunikační řešení pro tvorbu moderních komunikačních aplikací.</li>
   </ul>
   <a name="standards-webtransport"></a><h3>WebTransport</h3>
   <div>Integrace standardu <span class="bold">WebTransport</span> byl zvolena, jelikož představuje nejvhodnější variantu ze současných protokolů pro přenos dat v reálném čase a to z několika důvodů:</div>
   <ul class="spacelist">
    <li><span class="bold">Nízké latence</span>: Je navržen tak, aby minimalizoval latenci při navazování spojení a při výměně dat. To je zvláště důležité pro funkce vyžadující rychlou odezvu, jako jsou videohovory, videokonferenční hovory, hraní online her apod. Nízké latence celkově zlepšují uživatelskou přívětivost a zvyšují efektivitu komunikace.</li>
    <li><span class="bold">Vícekanálový přenos dat</span>: Umožňuje vícekanálový přenos dat, což znamená, že poskytuje současné zpracovávání více datových proudů v rámci jednoho spojení. Tato vlastnost je velmi užitečná pro <span class="bold">AMTP</span>, protože umožňuje efektivní přenos různých typů dat (například textových zpráv, souborů, videa apod.) bez nutnosti navazování nových spojení pro každý datový proud.</li>
    <li><span class="bold">Spolehlivé i nespolehlivé proudy dat v kanálech</span>: Podpora jak spolehlivého, tak i nespolehlivého proudu dat uvnitř kanálů poskytuje flexibilitu v závislosti na požadavcích dané funkcionality. Spolehlivé kanály zaručují doručení dat, zatímco nespolehlivé kanály mohou být využívány pro aplikace, kde je rychlost důležitější než spolehlivost (např. streamování živého videa, online hry apod.).</li>
    <li><span class="bold">Zabezpečení</span>: Zajišťuje bezpečné šifrované spojení mezi propojenými body. Tato vlastnost je klíčová pro ochranu citlivých dat a zajišťuje ochranu proti odposlechům a dalším formám kybernetických útoků.
    <li><span class="bold">Podpora obousměrné komunikace</span>: Umožňuje obousměrnou komunikaci mezi klientem a serverem v reálném čase, což je ideální pro interaktivní aplikace, jako jsou chatovací systémy, hlasové a video přenosy, online hry a další funkcionality využívající komunikaci v reálném čase.</li>
    <li><span class="bold">Škálovatelnost</span>: Díky efektivnímu využití síťových zdrojů a schopnosti snadno škálovat se zvyšujícím se nárůstem počtu uživatelů a datových proudů, je tento standard vhodný pro rozsáhlé nasazení, což umožňuje zvládat komunikaci s mnoha velkými objemy dat naráz bez výrazného zvýšení nákladů na infrastrukturu.</li>
    <li><span class="bold">Snadná integrace</span>: Jelikož je navržen s ohledem na integraci s moderními webovými aplikacemi, snadno se implementuje do serverových i klientských aplikací.</li>
   </ul>
   <a name="standards-bson"></a><h3>BSON</h3>
   <ul class="spacelist">
    <li><span class="bold">Lidsky čitelný formát</span>: I když je tento formát reprezentován v binární podobě, je jeho struktura odvozena z <span class="bold">JSON</span>, na který je snadno převeditelný a je tak dobře čitelný pro lidi a zárověň i zpracovatelný strojově.</li>
    <li><span class="bold">Strukturovanost</span>: Podporuje vnořené struktury, jako jsou objekty a pole, což umožňuje reprezentovat hierarchické datové struktury.</li>
    <li><span class="bold">Kompatibilita</span>: Je široce používán a jeho struktura je podporována většinou programovacích jazyků.</li>
    <li><span class="bold">Škálovatelnost</span>: Má schopnost škálovat do velmi komplexních a objemných datových struktur, u kterých umožňuje jejich snadné zpracování i efektivní přenos při velkých objemech.</li>
    <li><span class="bold">Interoperabilita</span>: Zajišťuje vysokou míru interoperability mezi různými systémy a aplikacemi. Taktéž může být snadno převeden na <span class="bold">JSON</span> a naopak, což usnadňuje výměnu dat mezi různými technologiemi a platformami.</li>
    <li><span class="bold">Podpora datových typů</span>: Rozšiřuje další typy dat, k již stávajícím, které jsou dostupné v <span class="bold">JSON</span>, jako např. binární data, datum a čas apod.</li>
    <li><span class="bold">Efektivita přenosu</span>: Je reprezentován v binární podobě, což znamená, že je efektivnější pro přenos po síti ve srovnání s textovými formáty jako např. <span class="bold">JSON</span>. Menší velikost dat poskytuje rychlejší přenos a nižší nároky na šířku pásma, což je vhodné pro přenosy velkých objemů.</li>
    <li><span class="bold">Snadné zpracování dat</span>: Umožňuje přímý přístup k jednotlivým prvkům dat, aniž by bylo potřeba procházet celý objekt, což zvyšuje rychlost a efektivitu při jeho zpracování. Tato vlastnost je zvláště užitečná pro implementaci komplexních funkcí, jako je filtrování nebo zpracovávání zpráv.</li>
    <li><span class="bold">Integrace s databázovými systémy</span>: Mnoho současných databázových systémů, jako je např. <a href="https://cs.wikipedia.org/wiki/MongoDB" target="_blank">MongoDB</a>, nativně používá <span class="bold">BSON</span> pro ukládání a zpracování dat. To může usnadnit integraci s těmito databázemi, což je výhodné pro aplikace vyžadující komplexní databázové operace.</li>
   </ul>
   <a name="architecture"></a><h2>Architektura</h2>
   <div>Architektura protokolu je navržena tak, aby poskytovala modulární, bezpečné a škálovatelné řešení v rámci distribuované sítě pro potřeby moderní elektronické komunikace v reálném čase.</div>
   <a name="architecture-network"></a><h3>Distribuovaná síť</h3>
   <div><span class="bold">Distribuovaná síťová architektura</span> v rámci <span class="bold">AMTP</span> přináší mnoho výhod, které jsou klíčové pro efektivní, bezpečné a odolné vzájemně propojené komunikační platformy. Zde jsou hlavní důvody, proč byl zvolen tento přístup:</div>
   <ul class="spacelist">
    <li><span class="bold">Odolnost proti výpadkům</span>: Distribuovaná síťová architektura zajišťuje, že selhání jednoho uzlu má pouze lokální dopad na uživatele připojené k tomuto uzlu, avšak nemá žádný přímý vliv na funkčnost a dostupnost ostatních uzlů v síti. Toto omezení dopadu umožňuje, aby byla zajištěna kontinuita služby pro ostatní uživatele, kteří jsou připojeni k ostatním uzlům. Tím je zajištěna vyšší celková robustnost a odolnost celé sítě vůči izolovaným technickým problémům nebo geograficky lokalizovaným výpadkům, což je klíčové pro udržení nepřetržité globální komunikace.</li>
    <li><span class="bold">Odolnost proti cenzuře</span>: Rozptýlení dat a služeb mezi velké množství poskytovatelů serverů v různých jurisdikcích může znesnadnit úsilí o cenzuru nebo úplné blokování služby, což zajišťuje větší svobodu a nezávislost informací. Pokud je uživatel cenzurován ze strany konkrétního provozovatele serveru, může si vybrat jiného provozovatele, který nabízí svobodnější alternativu. Pokud provozovatel služby je cenzurován ze strany regulačních orgánů (např. státu), může přesunout svá data do jiné, svobodnější jurisdikce.</li>
    <li><span class="bold">Konkurence mezi poskytovateli</span>: V distribuované síti existuje více nezávislých poskytovatelů služeb, kteří spravují různé uzly. To podporuje zdravou konkurenci, která vede k lepší kvalitě služeb, zavádění nových či vylepšení původních funkcionalit a jiným inovacím. Také může vést i ke snížení nákladů za placené služby pro koncové uživatele. Konkurence mezi poskytovateli také umožňuje uživatelům vybírat z různých služeb na základě kvality, ceny, ochrany soukromí a dalších faktorů, což zvyšuje možnosti volby a zlepšuje celkovou uživatelskou spokojenost.</li>
    <li><span class="bold">Nezávislost</span>: Pokud uživatel nemá zájem využívat služeb žádného poskytovatele služby, má možnost si spustit vlastní server s vlastními pravidly a nastaveními dle svých individuálních potřeb.</li>
    <li><span class="bold">Geografický výběr poskytovatele</span>: Distribuce serverů geograficky blíže k uživatelům může výrazně snížit latenci a zlepšit rychlost odezvy, což zlepšuje uživatelskou zkušenost při komunikaci a přenosu dat. Taktéž umožňuje vybrat si poskytovatele, který lépe vyhovuje lokálním potřebám, jako je podpora ve stejném jazyce, možnost osobního kontaktu apod. To zvyšuje komfort, spokojenost a posiluje důvěru uživatelů v poskytované služby.</li>
    <li><span class="bold">Místní přizpůsobení</span>: Distribuované sítě umožňují lokálním poskytovatelům služby se lépe přizpůsobit specifickým regionálním požadavkům uživatelů a nutnost dodržovat pouze lokální právní normy a nebýt tak svázán dodržováním regulací a norem z celého světa tak, jak je to u centralizovaných globálních služeb.</li>
    <li><span class="bold">Podpora pro inovace</span>: Distribuovaná síťová architektura umožňuje experimentování a inovace na jednotlivých uzlech bez rizika narušení celého systému. To může sloužit jako testovací prostor pro nové technologie a modely před jejich širším nasazením.</li>
    <li><span class="bold">Bezpečnost</span>: Útoky zaměřené na jednotlivé uzly nemají vliv na celou síť. Distribuovaná struktura komplikuje útočníkům snahu ovlivnit celý systém. Nežádoucí ovlivnění více uzlů v síti zvyšuje složitost a náklady na potenciální útoky.</li>
    <li><span class="bold">Ochrana soukromí</span>: Distribuovaná síťová architektura může přispět k lepší ochraně soukromí uživatelů tím, že data menších poskytovatelů nejsou uchovávána a zpracovávána velkými korporacemi, které mohou mít tendence velké množství dat uživatelů různými způsoby zpracovávat nebo sdílet pro různé účely (reklamní, trénink AI, spolupráce s vládami apod.)</li>
   </ul>
   <a name="architecture-modularity"></a><h3>Modularita</h3>
   <div>Ačkoliv tato dokumentace nepopisuje implementaci serverové aplikace, je důležité zmínit, že tento protokol počítá s použitím modulární architektury serveru a proto je třeba popsat nejen komunikaci v rámci příkazů síťového protokolu, ale i komunikaci mezi <span class="bold">jádrem</span> serveru a <span class="bold">moduly</span>.</div>
   <ul class="spacelist">
    <li><span class="bold">Jádro</span>: Stará se o síťovou komunikaci, komunikaci s moduly, komunikaci s <a href="https://cs.wikipedia.org/wiki/Domain_Name_System" target="_blank">DNS</a> a zajišťuje základní správu serveru.</li>
    <li><span class="bold">Moduly</span>: Zajišťují funkcionality serveru (např. zasílání rychlých zpráv, diskuzní fórum, blogy apod.). Každá serverová i klientská aplikace může využívat vlastní sadu modulů.</li>
   </ul>
   <div></div>
   <div>Po spojení klienta nebo cizího serveru s vlastním serverem je možné komunikovat buď napřímo s <span class="bold">jádrem</span> nebo s jednotlivými <span class="bold">moduly</span>. Na základě struktury příkazu, který je zaslán po síti, server určí, zda se jedná o příkaz, který má být zpracován jádrem nebo moduly. Pokud je určen příkaz modulu a modul ho zpracuje, vrátí odpověď jádru a jádro ho následně předá zpět připojenému klientovi nebo cizímu serveru, pro které je určen.</div>
   <div>Způsob komunikace serverového jádra s moduly není standardizován touto dokumentací, každá softwarová implementace může mít vlastní řešení (například výměna dat uvnitř aplikace, externě běžící služby propojené unixovými sockety, síťové spojení přes <span class="bold">WebTransport</span> apod.). V rámci tohoto protokolu jsou pouze popsány struktury dat v <span class="bold">BSON</span> formátu, které se doporučuje používat při komunikaci mezi jádrem a serverem.</div>
   <div><span class="bold">Modulární koncept architektury</span> protokolu poskytuje několik klíčových výhod:</div>
   <ul class="spacelist">
    <li><span class="bold">Přizpůsobení</span>: Díky modulární struktuře mohou provozovatelé serverů snadno vybírat specifické funkcionality dle svých potřeb nebo potřeb jejich uživatelů. Správci či uživatelé mohou vybrat pouze ty moduly, které potřebují, což umožňuje vytvořit řešení šité na míru bez zbytečného nadbytečného software. Například školy či firmy mohou využívat jiné moduly, než domácí uživatelé apod.</li>
    <li><span class="bold">Rychlý a snadný vývoj</span>: Modulární architektura umožňuje různým vývojovým týmům pracovat nezávisle na sobě na různých modulech, což zrychluje celkový vývoj systému, usnadňuje správu kódu a zvyšuje přehlednost v kódu. To je zvláště užitečné ve velkých projektech. Taktéž to šetří čas tím, že nemusí vytvářet celý systém od základu, ale jen specifické funkcionality.</li>
    <li><span class="bold">Snadná údržba a aktualizace</span>: Moduly lze nezávisle na sobě aktualizovat a vylepšovat. Takovéto aktualizace jednotlivých modulů mohou proběhnout bez přerušení zbylé části systému nebo nutnosti celý systém překompilovat či restartovat. To zároveň přináší i dlouhodobou životnost a udržitelnost systému tím, že usnadní integraci nových funkcionalit.</li>
    <li><span class="bold">Testování</span>: Každý modul lze testovat samostatně, což zjednodušuje proces odstranění chyb a zvyšuje celkovou kvalitu software. Integrace nových funkcionalit je také snazší a méně náchylná k chybám, jelikož se jednotlivé moduly testují nezávisle.</li>
    <li><span class="bold">Odolnost proti chybám</span>: V případě, že jeden z modulů selže, neovlivní to fungování ostatních částí systému, což přispívá k vyšší stabilitě, odolnosti a omezení rizik spojených s narušením celého systému.</li>
    <li><span class="bold">Bezpečnost</span>: Každému modulu lze udělit různá omezená práva v rámci operačního systému, což zajišťuje zvýšenou bezpečnost celého systému.</li>
    <li><span class="bold">Multiverzování</span>: V rámci jednoho serveru může běžet stejný modul ve více verzích najednou. To umožňuje serveru být kompatibilní pro nové i starší verze klientských aplikací.</li>
    <li><span class="bold">Interoperabilita</span>: Moduly mohou být navrženy tak, aby mohly komunikovat a spolupracovat mezi sebou a také s různými dalšími externími zdroji, se kterými taktéž mohou sdílet data.</li>
    <li><span class="bold">Geografická nezávislost</span>: Moduly mohou běžet na různém hardware umístěným na různých místech v síti.</li>
    <li><span class="bold">Finanční efektivita</span>: Vývojáři mohou snadno vytvářet pouze určitou část systému, nikoliv celý systém a zároveň je jim umožněno svou funkcionalitu nabídnout již existující komunitě lidí, kteří systém využívají. To značným způsobem šetří náklady a zvyšuje potenciální výnosnost.</li>
   </ul>
   <div>Následující obrázek nastiňuje zjednodušený příklad toho, jak může vypadat modulární architektura serverové aplikace:</div>
   <div class="center"><img src="img/AMTP-server-CZ.png" alt="Architektura serveru" /></div>
   <a name="identity"></a><h2>Identita uživatele</h2>
   <div>Každý uživatelský účet v rámci <span class="bold">AMTP</span> je identifikován adresou, jejíž formát vychází původních e-mailových standardů, s několika odlišnostmi a je definován následovně:</div>
   <ul class="spacelist">
    <li><span class="bold">Adresa</span>: sestává se z <span class="bold">lokální</span> a <span class="bold">doménové</span> části. Tyto části jsou odděleny znakem "<span class="bold">@</span>" (zavináč). Tedy ve tvaru: <span class="bold">uživatel@doména</span></li>
    <ul>
     <li>
      <span class="bold">Lokální část</span>: určuje unikátní uživatelské jméno v rámci každé domény a obsahuje následující povolené znaky:</li>
      <ul>
       <li><span class="bold">Malá písmena</span>: (a-z) - pouze anglické abecedy  - na jakékoliv pozici</li>
       <li><span class="bold">Číslice</span>: (0-9) - na jakékoliv pozici</li>
       <li><span class="bold">Speciální znaky</span>: tečka (.), pomlčka (-) a podtržítko (_) - tyto znaky nesmějí být použity na začátku ani na konci lokální části (tedy nikoliv např. <span class="bold">john-@example.com</span>) a nesmí se dva nebo více speciálních znaků objevit za sebou v jakékoliv kombinaci (tedy nikoliv např. <span class="bold">john.-doe@example.com</span>).</li>
       <li>Velká písmena anglické abecedy jsou tolerována a automaticky převáděna na malá písmena.</li>
      </ul>
     <li><span class="bold">Doménová část</span>: určuje doménu, ke které má užívací právo provozovatel serveru (každý AMTP server může spravovat libovolné množství domén). Doménová jména mohou obsahovat znaky dle aktuálních standardů pro domény (definované v <a href="https://www.rfc-editor.org/rfc/rfc5890.html" target="_blank">RFC 5890</a>, <a href="https://www.rfc-editor.org/rfc/rfc5891.html" target="_blank">RFC 5891</a>, <a href="https://www.rfc-editor.org/rfc/rfc5892.html" target="_blank">RFC 5892</a> a <a href="https://www.rfc-editor.org/rfc/rfc5893.html" target="_blank">RFC 5893</a>.</li>
    </ul>
    <li><span class="bold">Viditelné jméno</span>: V rámci <span class="bold">AMTP</span> se již nepoužívá formát zápisu s viditelným jménem, který je známý z původních e-mailových protokolů (např.: "<span class="bold">John Doe &lt;john.doe@example.com&gt;</span>").</li>
    <li><span class="bold">Účel identity</span>: Narozdíl od původních e-mailových protokolů, <span class="bold">AMTP</span> nedefinuje, co uživatelský účet reprezentuje (např. poštovní schránku, alias pro přeposílání pošty apod.). To je plně v režii modulů (např. modul pro rychlé zprávy).</li>
    <li><span class="bold">Profilové informace</span>: Uživatelský účet v protokolovém jádru neobsahuje žádné další profilové informace (např. jméno, příjmení, pohlaví, datum narození, fotografie apod.). Tyto informace jsou plně v kompetenci modulů, kde mohou být reprezentovány v podobě uživatelských profilů. Tento přístup dává modulům svobodu v rozhodnutí, zda každý uživatelský účet bude reprezentovat jen jeden a nebo více uživatelských profilů, tzn. přihlášením k jednomu uživatelskému účtu se může uživatel dostat k několika svým profilům). Taktéž tento přístup zajišťuje možnost nezveřejňovat adresu uživatelského účtu, pokud moduly budou zobrazovat jiný typ identifikace profilů.</li>
   </ul>
   <a name="security"></a><h2>Zabezpečení</h2>
   <div><span class="bold">Zabezpečení dat</span> je klíčovou součástí moderního komunikačního protokolu, jelikož s rostoucími objemy přenášených dat mezi uživateli, roste i riziko jejich potenciálního zneužití.</div>
   <div><span class="bold">AMTP</span> je navržen s důrazem na komplexní zabezpečení a to na několika úrovních, které jsou popsány v této části dokumentace. Další úrovně zabezpečení mohou být doplněny v jednotlivých modulech.</div>
   <a name="security-transfer"></a><h3>Šifrovaný přenos dat</h3>
   <div>Šifrovaný přenost dat v je vyřešen v <span class="bold">AMTP</span> díky tomu, že využívá <span class="bold">WebTransport</span> spojení, které integruje protokol <a href="https://cs.wikipedia.org/wiki/QUIC" target="_blank">QUIC</a>, který používá šifrování na úrovni transportní vrstvy. Všechna přenášená data v rámci spojení jsou šifrována pomocí <a href="https://cs.wikipedia.org/wiki/Transport_Layer_Security" target="_blank">TLS</a>. Toto zahrnuje šifrování všech přenášených dat, vč. hlaviček a metadat, což minimalizuje riziko úniku citlivých informací a zároveň zajišťuje integritu dat tak, aby bylo zabráněno jejich modifikaci během přenosu.</div>
   <div>Pro tento účel je vyžadován platný šifrovací certifikát, vydaný certifikační autoritou (např. <a href="https://cs.wikipedia.org/wiki/Let%27s_Encrypt" target="_blank">Let's Encrypt</a>). Spojení s certifikátem s vlastním podpisem (bez certifikační autority) není povoleno (jak pro spojení <span class="bold">klient-server</span>, tak i pro <span class="bold">server-server</span>), protože u nich nelze ověřit identitu (může je vydat kdokoliv), proto je nutné si takový certifikát nechat vystavit od certifikační autority a používat ho pro účely jak šifrovaného přenosu dat, tak i pro ověření identity serveru.</div>
   <a name="security-dkey"></a><h3>Digitální podpis serveru</h3>
   <div><span class="bold">Digitální podpis serveru</span> slouží k ověření, zda server, ke kterému se klient či jiný server připojuje, je opravdu ten, za který se vydává. Toto je bezpečnostní mechanismus, který zabraňuje útokům, jako je např. <a href="https://cs.wikipedia.org/wiki/IP_spoofing" target="_blank">IP spoofing</a>.</div>
   <div>Po nainstalování každého serveru se vygeneruje <span class="bold">soukromý klíč</span> a z něj odvozený <span class="bold">veřejný klíč</span> algoritmem, který podporují ostatní serverové i klientské aplikace. <span class="bold">Soukromý klíč</span> zůstává bezpečně uložen na serveru. <span class="bold">Veřejný klíč</span> společně s identifikací šifrovacího algoritmu se uloží do <span class="bold">DNS</a> do <span class="bold">TXT</span> záznamu <span class="bold">AMTP-PUBKEY</span>.</div>
   <div>Ihned po navázání spojení vlastního serveru či klienta s protějším serverem, se zašle dotaz protějšímu serveru se žádostí o podepsání námi náhodně vygenerovaného řetězce. Protější server podepíše tento řetězec svým <span class="bold">soukromým klíčem</span> a odešle ho zpět. Náš server nebo klient odešle následně dotaz do <span class="bold">DNS</span> pro získání <span class="bold">TXT</span> záznamu <span class="bold">ATMP-PUBKEY</span> uvedený k protějšímu serveru a tím získá  jeho <span class="bold">veřejný klíč</span>. Náš server či klient následně ověří zda podepsaný řetezec odpovídá <span class="bold">veřejnému klíči</span> získanému z <span class="bold">DNS</span>. Pokud je podpis platný, nadále se komunikuje s protějším serverem, v opačném případě je ukončeno spojení.</div>
   <div>V případě spojení <span class="bold">server-server</span> se po ověření protějšího serveru, provede stejné ověření z opačné strany (protější server si ověří náš server).</div>
   <div class="center"><img src="img/AMTP-dkey-CZ.png" alt="Digitální podpis serveru" /></div>
   <a name="security-login"></a><h3>Bezpečné přihlašování</h3>
   <div>Proces ověřování uživatelů a správců je navržen tak, aby bylo zajištěno, že citlivé informace, jako je <a href="https://cs.wikipedia.org/wiki/Asymetrick%C3%A1_kryptografie" target="_blank">soukromý klíč</a>, zůstanou uloženy vždy jen na zařízení uživatele a nikam se nezasílají. Toho je dosaženo pomocí asymetrické šifrovací strategie zvané <span class="bold">výzva-odezva</span>, která je popsána následovně:</div>
   <div class="bold">1. Vygenerování klíčů:</div>
   <ul>
    <li>Po zahájení procesu registrace klient vygeneruje na svém koncovém zařízení jedinečný soukromý klíč. S využitím šifrovacího algoritmu kompatibilního s algoritmy podporovanými serverovou aplikací je z tohoto soukromého klíče odvozen odpovídající <a href="https://cs.wikipedia.org/wiki/Asymetrick%C3%A1_kryptografie" target="_blank">veřejný klíč</a>. Tato dokumentace nespecifikuje seznam podporovaných šifrovacích algoritmů, to je plně na implementaci serveru a klientských aplikací a dává to možnost změny algoritmů v budoucnu. <span class="bold">Soukromý klíč</span> je bezpečně uložen v klientském zařízení.</li>
   </ul>
   <div class="bold">2. Registrace účtu:</div>
   <ul>
    <li><span class="bold">Veřejný klíč</span> spolu s identifikací použitého šifrovacího algoritmu se předává serveru při registraci účtu na serveru. Server poté uloží <span class="bold">veřejný klíč</span> a identifikaci šifrovacího algoritmu do svého úložiště (např. databáze) pro budoucí procesy ověřování.</li>
   </ul>
   <div class="bold">3. Ověřování při přihlášení:</div>
   <ul>
    <li>Klient nejprve odešle serveru žádost o přihlášení spolu se svým uživatelským jménem a případně i heslem, pokud je používáno.</li>
    <li>Server vygeneruje náhodný řetězec (doporučuje se délka řetězce alespoň 40 znaků), který je následně zašifrován pomocí <span class="bold">veřejného klíče</span> klienta a poté je v této zašifrované formě odeslán klientovi spolu s jeho veřejným klíčem a identifikací šifrovacího algoritmu. Doporučuje se časově omezit platnost zašifrovaného řetězce (dobu platnosti si určí server, doporučená doba platnosti je zhruba 30 vteřin).</li>
    <li>Po přijetí klient použije svůj <span class="bold">soukromý klíč</span> k rozšifrování přijatého řetězce a odešle rozšifrovaný řetězec zpět na server k ověření.</li>
    <li>Server porovná rozšifrovaný řetězec s původně vygenerovaným řetězcem. Pokud se tyto dva řetězce shodují, je uživatel či správce přihlášen. V případě uživatelů (nikoliv správců) je zároveň i vydán token relace. Token relace by měl být taktéž časově omezen (dobu platnosti si určí server, doporučená doba platnosti je 30 dní). Platnost tokenu se doporučuje prodlužovat na dobu jeho platnosti od chvíle zaslání každého příkazu. Tím se zajistí, že token expiruje pouze při neaktivitě uživatele, případně jeho ručním odstraněním. Správci nepotřebují token relace, jelikož se přihlašují jen na krátkou dobu (po dobu spojení se serverem).</li>
   </ul>
   <div>Tato metoda ověřování využívá výhody asymetrického šifrování k ochraně uživatelských dat a zajišťuje, že citlivé informace, jako jsou <span class="bold">soukromé klíče</span>, zůstanou chráněny v rámci koncových zařízení uživatelů. Tento přístup zvyšuje bezpečnost a je v souladu s osvědčenými postupy pro bezpečnou komunikaci v moderních aplikacích.</div>
   <div>Ověření uživatele pomocí soukromého klíče může být rozšířeno i ověřením hesla (standardně nepovinné, server si povinnost hesla může vynutit), které je zasláno při registraci v zahashované formě (výběr šifrovacího algoritmu je v kompetenci serverové a klientské aplikace). Tímto se docílí dodatečného zabezpečení pro případ, kdyby byl privátní klíč zkompromitován.</div>
   <div class="center"><img src="img/AMTP-login-CZ.png" alt="Bezpečné přihlašování" /></div>
   <a name="security-block"></a><h3>Blokace neautorizovaných přístupů</h3>
   <div>Protokol počítá s obranými strategiemi, které mohou být implementovány v serverové aplikaci, které zajišťují ochranu systému před opakovanými pokusy o neautorizovaný přístup jak ze strany klientů, tak ze strany cizích serverů. Tyto strategie představují mechanismus, jak se bránit <a href="https://cs.wikipedia.org/wiki/%C3%9Atok_hrubou_silou" target="_blank">útokům hrubou silou</a> a to v následujících oblastech:</div>
   <ul class="spacelist">
    <li><span class="bold">Uživatelské účty a uživatelské tokeny relace</span>: V případě, že klient se pokouší opakovaně neúspěšně přihlásit pod uživatelským účtem nebo opakovaně používá neplatný token relace, systém ho automaticky zablokuje.</li>
    <li><span class="bold">Správcovské účty</span>: V případě, že klient se pokouší opakovaně neúspěšně přihlásit pod správcovským účtem, systém ho automaticky zablokuje. Pro tyto případy se doporučuje nastavit výrazně přísnější pravidla blokace, než v případě uživatelských účtů, protože účty s administrátorskými právy mají značně rozšířené možnosti ovlivňování systému.</li>
    <li><span class="bold">Digitální podpis serveru</span>: V případě, že cizí server se pokouší připojit a neprojde opakovaně procesem ověřením svého digitálního podpisu, je takový server považován za podvodný a je doporučeno ho zablokovat.</li>
   </ul>
   <div>Blokace ve výše uvedených případech je definována na konkrétní IP adresu nebo rozsah IP adres protistrany. Nastavení přísnosti pravidel pro blokaci neautorizovaných přístupů je plně v kompetenci implementace serverové aplikace. Tato pravidla nemusí být serverem implementována vůbec, důrazně se však doporučuje je implementovat.</div>
   <a name="security-sign"></a><h3>Podepisování obsahu</h3>
   <div>Veškerý obsah, který uživatel zasílá na server (např. zaslání rychlé zprávy, vložení příspěvku do newsfeedu, uložení blogového článku, vložení příspěvku do diskuzního fóra apod.), by měl být podepsán <span class="bold">privátním klíčem</span> uživatele a to ještě předtím, než je tento obsah zašifrován pomocí <a href="https://cs.wikipedia.org/wiki/Koncov%C3%A9_%C5%A1ifrov%C3%A1n%C3%AD" target="_blank">koncového šifrování</a>. <span class="bold">Veřejný klíč</span>, kterým je možné podpis ověřit, může uživatel vystavit kdekoliv mimo svůj vlastní server (např. na své webové stránce, na jiný <span class="bold">AMTP</span> server, případně na jiné službě, která je k tomuto účelu určená). Tímto <span class="bold">veřejným klíčem</span> pak může kdokoliv ověřit, že obsah opravdu pochází od uživatele, který jej zaslal na server. Tímto se dá předejít případům, kdy by mohl správce serveru podvrhnout obsah pod jménem uživatele, který má na serveru účet nebo kdyby server byl napaden a vydával obsah jménem některého z uživatelů, který je na něm registrovaný. Implementace podepisování obsahu v modulech není povinná, ale velmi se doporučuje.</div>
   <div>Taktéž této vlastnosti lze využít, když se uživatel rozhodne zmigrovat svůj účet (identitu) na jiný server (pod jinou doménou). Uživatelé si pak mohou díky původnímu podpisovému klíči ověřit, že se jedná o původního uživatele a nikoliv někoho jiného, kdo by se mohl za něj vydávat.</div>
   <a name="security-e2e"></a><h3>Koncové šifrování</h3>
   <div>Data zabezpečená <span class="bold">koncovým šifrováním</span> představují další vrstvu zabezpečení nejen v případě selhání šifrování v rámci zabezpečeného spojení mezi klientem a serverem, ale i k tomu, aby nikdo, kromě koncových uživatelů neměl přístup k datům (např. ani správce serveru, na kterém má uživatel založený uživatelský účet).</div>
   <div><span class="bold">Koncové šifrování</span> není předmětem této dokumentace, jelikož je v kompetenci jednotlivých modulů (např. zprávy, telefonování apod.). I tak je třeba zmínit, že by mělo být implementováno ve veškerých funkcionalitách modulů, kde se přenáší soukromá data mezi koncovými uživateli nebo skupinami uživatelů. Taktéž je doporučeno vytvářet moduly tak, aby klíče byly často obměňovány.</div>
   <a name="dns"></a><h2>DNS</h2>
   <div>Pro zajištění komunikace mezi servery v rámci distribuované sítě, jsou využity specifické <span class="bold">DNS</span> záznamy pro <span class="bold">AMTP</span>. Tyto záznamy jsou nezbytné pro správné a bezpečné směrování provozu mezi servery na základě jejich domén. Pro zapojení serveru do sítě pro účel předávání dat mezi servery, jsou nezbytné záznamy v <span class="bold">DNS</span> u domén, které jsou serverem využívány. Bez těchto záznamů není možné předávat data mezi servery.</div>
   <div>V původních e-mailových standardech bylo využito několik záznamů v <span class="bold">DNS</span>, jejichž funkcionalita byla nahrazena v <span class="bold">AMTP</span> jinými specifickými doménovými záznamy. Následující tabulka vysvětluje, čím byly v rámci tohoto protokolu nahrazeny záznamy známé z původních e-mailových standardů:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Záznam původních standardů</th>
      <th>Nahrazen AMTP záznamem</th>
      <th>Poznámka</th>
     </tr>
     <tr>
      <td>A / AAAA</td>
      <td>A / AAAA</td>
      <td>Záznam určující doménové jméno serveru je zachován.</td>
     </tr>
     <tr>
      <td>PTR</td>
      <td>-</td>
      <td>Záznam není již potřeba, jelikož představuje zastaralý způsob ověření serveru. V AMTP je legitimita každého serveru ověřena pomocí "TXT - AMTP-PUBKEY" záznamu.</td>
     </tr>
     <tr>
      <td>MX</td>
      <td>TXT - AMTP-SERVERS</td>
      <td>Záznam určující který server je přiřazen ke kterému doménovému jménu, na kterém jsou uživatelské účty.</td>
     </tr>
     <tr>
      <td>TXT - SPF</td>
      <td>-</td>
      <td>Tento záznam není potřeba, jelikož jeho funkci zastává "TXT - AMTP-SERVERS" záznam.</td>
     </tr>
     <tr>
      <td>TXT - DKIM</td>
      <td>TXT - AMTP-PUBKEY</td>
      <td>Záznam určující veřejný klíč serveru, kterým si cizí servery ověřují legitimitu užívání doménového jména v adresách uživatelských účtů</td>
     </tr>
     <tr>
      <td>TXT - DMARC</td>
      <td>-</td>
      <td>Záznam již není potřeba. Reporting neúspěšných pokusů o předání dat ze serverů, které postrádají legitimitu užívání účtů na cizích doménách pro legitimní servery je zbytečný, jelikož v rámci AMTP se nemůže stát, že takové zprávy by byly vůbec doručeny. Pokud by byl nějaký reporting potřeba, je možné na tuto funkcionalitu vytvořit modul.</td>
     </tr>
    </table>
   </div>
   <a name="dns-config"></a><h3>Konfigurace DNS</h3>
   <div class="bold">TXT - AMTP-SERVERS záznam:</div>
   <ul>
    <li>Tento záznam definuje cílové servery, na kterých jsou uživatelské účty pro určitou doménu (kombinuje funkcionalitu podobnou záznamům MX a SPF, které jsou určeny pro původní e-mailové protokoly).</li>
    <li>Záznam se určuje pro konkrétní doménu, která je určená pro adresy uživatelských účtů a definuje se řetězcem "<span class="bold">amtp-servers=</span>", po kterém následuje seznam jednotlivých serverů, které jsou odděleny čárkou (",")</li>
    <li>Servery jsou seřazeny podle priority. Pokud je některý server nedostupný, použije se pro připojení další server v řadě.</li>
    <li>Pokud není zadán žádný port, použije se standardně port 443.</li>
   </ul>
   <div class="bold">Příklad:</div>
<pre>
subdomain.example.com. IN TXT "amtp-servers=amtp1.example.com,amtp2.example.com:12345,amtp3.example.com:23456"
</pre>
   <div>Tento záznam definuje, že pro účty na doméně <span class="bold">@subdomain.example.com</span> jsou používány následující servery <span class="bold">AMTP</span>:</div>
   <ul>
    <li><span class="bold">amtp1.example.com</span> na portu 443</li>
    <li><span class="bold">amtp2.example.com</span> na portu 12345</li>
    <li><span class="bold">amtp3.example.com</span> na portu 23456</li>
   </ul>
   <div class="bold">TXT - AMTP-PUBKEY záznam:</div>
   <ul>
    <li>Tento záznam definuje, jaký veřejný klíč používá server ke své identifikaci po spojení s protějším serverem.</li>
    <li>Záznam začíná řetězcem "<span class="bold">amtp-pubkey=</span>", po kterém následují parametry oddělené čárkou:</li>
    <ul>
     <li>"<span class="bold">e:</span>" + název šifry</li>
     <li>"<span class="bold">k:</span>" + veřejný klíč</li>
    </ul>
   </ul>
   <div class="bold">Příklad:</div>
<pre>
amtp1.example.com. IN TXT "amtp-pubkey=e:rsa,k:123456789abcdef"
</pre>
   <div>Tento příklad uvádí, že pro server <span class="bold">amtp1.example.com</span> je používán veřejný klíč "<span class="bold">123456789abcdef</span>" se šifrovacím algoritmem <a href="https://cs.wikipedia.org/wiki/RSA" target="_blank">RSA</a>.</div>
   <a name="connection"></a><h2>Spojení</h2>
   <div><span class="bold">Spojení</span> jsou realizována jak mezi klientem a serverem, tak i mezi servery navzájem.</div>
   <ul class="spacelist">
    <li><span class="bold">Spojení server-server</span> - Servery jsou organizovány do distribuované sítě, kde každý server je schopný předávat data ostatním serverům. Tato komunikace je realizována přes spojení, které nemusí být perzistentní a může být ukončeno jednou nebo druhou stranou kdykoliv to jedna ze stran uzná za vhodné (např. server odesilatele po dokončení doručování dat nebo server příjemce po vypršení určitého časového limitu, kdy mezi servery nedošlo k žádné výměně dat). Podmínky za kterých dochází k odpojování serverů mezi sebou nejsou standardizováné touto dokumentací, jsou plně v kompetenci konkrétní implementace serverové aplikace. Důvodem je například to, že některé servery mohou mít omezené systémové prostředky a tak mohou spojení s ostatními servery častěji odpojovat. Naopak servery, které mají dostatečné systémové prostředky, mohou udržovat otevřené spojení s ostatními servery pro rychlejší komunikaci, bez nutnosti opětovného navazování spojení.</li>
    <li><span class="bold">Spojení klient-server</span> - Každý klient je spojen se svým serverem prostřednictvím trvalého spojení. Pokud dojde k výpadku, automaticky se znovu klient k serveru připojí. Takováto spojení slouží jako stabilní kanál pro všechny operace, které klient potřebuje vykonávat (např. příjem zpráv, získávání notifikací, synchronizace dat apod.). Trvalá připojení klienta jsou klíčová pro udržení nepřetržité komunikace pro funkcionality, které vyžadují okamžité reakce, jako jsou např. rychlé zprávy nebo online hry. Díky <span class="bold">WebTransportu</span> mohou tato spojení efektivně spravovat více datových proudů současně, což minimalizuje zpoždění a zvyšuje celkovou uživatelskou spokojenost.</li>
   </ul>
   <div>Na straně serveru je spuštěn <a href="https://cs.wikipedia.org/wiki/HTTPS" target="_blank">HTTPS</a> server s platným šifrovacím certifikátem vydaným certifikační autoritou a podporujícím standard <a href="https://cs.wikipedia.org/wiki/HTTP/3" target="_blank">HTTP/3</a>. Přesný způsob komunikace je podrobně popsán v dokumentu <a href="https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3" target="_blank">WebTransport over HTTP/3</a>.</div>
   <div>Po připojení k endpointu <span class="bold">/amtp/</span> je vytvořena <span class="bold">WebTransport</span> session, v rámci které je možné otevírat a zavírat jednotlivé proudy, ve kterých probíhá komunikace pomocí příkazů. Více proudů může běžet souběžně.</div>
   <div>Ihned po navázání spojení se serverem pošle server automaticky protější straně informace o sobě, které jsou také přístupné pod příkazem <span class="bold">user_info</span>.</div>
   <div>Následující schéma nastiňuje příklad toho, jak fungují spojení klientů a serverů v rámci <span class="bold">AMTP</span>:</div>
   <div class="center"><img src="img/AMTP-network-CZ.png" alt="Distribuovaná síť" /></div>
   <a name="commands"></a><h2>Příkazy</h2>
   <div>Příkazy jsou zasílány přes <span class="bold">WebTransport</span> pomocí obousměrného proudu dat. V rámci zasílání všech příkazů jádra protokolu se používají výhradně spolehlivé proudy. Moduly mohou používat spolehlivé i nespolehlivé proudy, dle konkrétních potřeb.</div>
   <div>V rámci každého příkazu se nejprve otevře proud, poté probíhá obousměrná komunikace pomocí strukturovaných příkazů a nakonec, jakmile již není potřeba mít proud otevřený, uzavře se jednou či druhou stranou, zatímco spojení může být stále zachováno dokud je potřeba. Více proudů v rámci jednoho spojení může běžet souběžně.</div>
   <a name="commands-structure"></a><h3>Struktura příkazů a odpovědí</h3>
   <div>Příkazy a odpovědi mezi klientem či cizím serverem a vlastním serverem jsou strukturovány ve formátu <span class="bold">BSON</span>. Datové typy parametrů tedy taktéž vycházejí z tohoto standardu. Pokud se kdekoliv uvádí datum a čas, je výhradně zapisován v UTC formátu dle <a href="https://cs.wikipedia.org/wiki/ISO_8601" target="_blank">ISO 8601</a>.</div>
   <div class="bold">Struktura příkazu pro server:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</td>
      <th>Popis</th>
     </tr>
     <tr>
      <td>command</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Název příkazu</td>
     </tr>
     <tr>
      <td>params</td>
      <td>object</td>
      <td class="center">❌</td>
      <td>Objekt, obsahující jednotlivé parametry příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad příkazu pro server:</div>
<pre>
{
 "command": "some_command",
 "params": {
  "param1": "value1",
  "param2": "value2",
  "param3": "value3"
 }
}
</pre>
   <div class="bold">Struktura odpovědi od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</td>
      <th>Popis</th>
     </tr>
     <tr>
      <td>error</td>
      <td>32-bit integer</td>
      <td class="center">✔</td>
      <td>Číslo chyby. V případě bezchybného provedení příkazu vždy = 0.</td>
     </tr>
     <tr>
      <td>message</td>
      <td>string</td>
      <td class="center">❌</td>
      <td>Parametr se zprávou o provedení příkazu - v případě chyb je povinný, v případě úspěšného zpracování je volitelný</td>
     </tr>
     <tr>
      <td>data</td>
      <td>object</td>
      <td class="center">❌</td>
      <td>Objekt, obsahující data odpovědi</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad odpovědi od serveru při úspěšném zpracování:</div>
<pre>
{
 "error": 0,
 "data": {
  "param1": "value1",
  "param2": "value2",
  "param3": "value3"
 }
}
</pre>
   <div class="bold">Příklad odpovědi od serveru při chybě:</div>
<pre>
{
 "error": 123,
 "message": "Some error description"
}
</pre>
   <a name="commands-errors"></a><h3>Chyby</h3>
   <div>V této části dokumentace je popsána struktura obecných chyb, chyb jádra a modulů.</div>
   <a name="commands-errors-general"></a><h4>Obecné chyby jádra</h4>
   <div>Následující chyby nastávají nikoliv jako přímé odpovědi příkazů, ale při dalších speciálních událostech.</div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">900</td>
      <td>Unknown error</td>
      <td>Vyskytla se neznámá chyba</td>
     </tr>
     <tr>
      <td class="center">901</td>
      <td>Invalid BSON command</td>
      <td>Obdržen neplatný BSON příkaz</td>
     </tr>
     <tr>
      <td class="center">902</td>
      <td>Unknown command</td>
      <td>Obdržen neznámý příkaz</td>
     </tr>
     <tr>
      <td class="center">903</td>
      <td>Admin is not logged in</td>
      <td>Správce není přihlášen</td>
     </tr>
     <tr>
      <td class="center">904</td>
      <td>User is not logged in</td>
      <td>Uživatel není přihlášen</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad obecné chyby:</div>
<pre>
{
 "error": 900,
 "message": "Unknown error"
}
</pre>
   <a name="commands-errors-commands"></a><h4>Chyby příkazů jádra</h4>
   <div>Pokud příkaz vrátí chybu, je strukturována následovně:</div>
   <div class="bold">Struktura chyby z jádra serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>error</td>
      <td>32-bit integer</td>
      <td class="center">✔</td>
      <td>Stavové číslo chyby</td>
     </tr>
     <tr>
      <td>message</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Zpráva s chybou</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad chyby z jádra serveru:</div>
<pre>
{
 "error": 1,
 "message": "User not found"
}
</pre>
   <a name="commands-errors-modules"></a><h4>Chyby příkazů modulů</h4>
   <div>Struktura chyb generovaných moduly si definuje modul sám dle svých potřeb. Doporučuje se pro lepší přehlednost používat stejnou strukturu jako používá jádro - tedy s parametry <span class="bold">error</span> a <span class="bold">message</span>.</div>
   <a name="commands-c2s"></a><h3>Klient-server</h3>
   <div>V této části dokumentace jsou popsány příkazy, které jsou využívány v komunikaci mezi klientskou aplikací a jádrem serverové aplikace.</div>
   <a name="commands-c2s-admin"></a><h4>Příkazy správce</h4>
   <div>Všechny příkazy začínající "<span class="bold">admin_</span>" jsou určeny pouze pro správce serveru. Aby bylo možné provádět tyto příkazy (mimo příkazů pro samotné přihlášení), musí být správce přihlášen. Pokud je přihlášení úspěšné, je správce přihlášen po dobu spojení.</div>
   <a name="commands-c2s-admin-login"></a><h5>Přihlášení správce</h5>
   <div>Přihlášení správce probíhá ve dvou krocích - přihlašovací výzvě a přihlašovací odezvě. V přihlašovací výzvě zašle klient své přihlašovací jméno a pokud používá mimo privátního klíče i heslo, tak i hash tohoto hesla (nepovinné). Server ověří heslo (pokud správce používá) a následně vygeneruje náhodný řetězec, který server zašifruje veřejným klíčem správce. Tento zašifrovaný řetězec je předán správci. Správce následně řetězec rozšifruje pomocí svého soukromého klíče a zašle ho zpět v rámci přihlašovací odezvy. Server ho porovná s původně vygenerovaným řetězcem a v případě, že řetětec od klienta odpovídá původně vygenerovanému, pak je správce přihlášen po dobu spojení. V opačném případě vrátí chybu.</div>
   <a name="commands-c2s-admin-login-challenge"></a><h6>Výzva</h6>
   <div><span class="bold">Upozornění</span>: Po dokončení přihlašovací výzvy se neukončuje proud. Následuje po ní přihlašovací odezva.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_login_challenge</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>user</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Uživatelské jméno</td>
     </tr>
     <tr>
      <td>password</td>
      <td>string</td>
      <td class="center">❌</td>
      <td>Hash hesla</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>encrypted_string</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>string výzvy pro zašifrování</td>
     </tr>
     <tr>
      <td>public_key</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Veřejný klíč, kterým byl řetězec zašifrován</td>
     </tr>
     <tr>
      <td>encryption_algorithm</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Identifikace algoritmu, kterým byl řetězec zašifrován</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>User name not set</td>
      <td>Uživatelské jméno nebylo vyplněno</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>Password not set</td>
      <td>Heslo nebylo vyplněno</td>
     </tr>
     <tr>
      <td class="center">3</td>
      <td>User name not found</td>
      <td>Uživatelské jméno nebylo nenalezeno</td>
     </tr>
     <tr>
      <td class="center">4</td>
      <td>Wrong password</td>
      <td>Heslo je chybné</td>
     </tr>
     <tr>
      <td class="center">5</td>
      <td>User is already logged in</td>
      <td>Uživatel je již přihlášen</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_login_challenge",
 "params": {
  "user": "admin",
  "password": "$argon2id$v=19$m=12,t=3,p=1$Ym9lOGY4Z2JpNGcwMDAwMA$/tlnuG0YNErs5KviawcLcg"
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": 0,
 "data": {
  "encrypted_string": "1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B3C4D5E6F1A2B",
  "public_key": "1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF",
  "encryption_algorithm": "rsa4096oaep"
 }
}
</pre>
   <a name="commands-c2s-admin-login-response"></a><h6>Odezva</h6>
   <div><span class="bold">Upozornění</span>: Tuto přihlašovací odezvu předchází přihlašovací výzva, není to tedy samostatný příkaz. Po úspěšném dokončení přihlašovací výzvy následuje tato přihlašovací odezva ve stejném proudu, ve kterém byla zaslána přihlašovací výzva. Po dokončení této přihlašovací odezvy je tento proud uzavřen.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_login_response</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>decrypted_string</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Rozšifrovaný řetězec z přihlašovací výzvy soukromým klíčem</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>Decrypted string not set</td>
      <td>Rozšifrovaný řetězec chybí</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>No login request sent</td>
      <td>Přihlašovací výzva nebyla ještě zpracována, je nejprve nutné ji provést</td>
     </tr>
     <tr>
      <td class="center">3</td>
      <td>Wrong decrypted string</td>
      <td>Nesprávně rozšifrovaný řetězec</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_login_response",
 "params": {
  "decrypted_string": "abcdefghijklmnopqrstuvwxyz1234567890abcd"
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": 0,
 "message": "Admin logged in"
}
</pre>
   <a name="commands-c2s-admin-logout"></a><h5>Odhlášení správce</h5>
   <div>Tento příkaz odhlásí správce, pokud byl přihlášen.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_logout</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>User is not logged in</td>
      <td>Uživatel nebyl přihlášen, tudíž není možné ho odhlásit</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_logout"
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": 0,
 "message": "Admin logged out"
}
</pre>
   <a name="commands-c2s-admin-setpubkey"></a><h5>Změna vlastního veřejného klíče pro přihlášení</h5>
   <div>Tento příkaz změní přihlašovací veřejný klíč uživatele. K tomu, aby mohl být veřejný klíč změněn, je třeba poskytnout přihlašovací výzvu a odezvu, stejně, jako je to u běžného přihlášení a to i v případech, kdy je uživatel již přihlášen. Toto dodatečné přihlášení uvnitř tohoto příkazu je implementováno proto, aby nikdo nemohl neoprávněně změnit veřejný klíč na serveru již přihlášenému uživateli, například při použití jeho zařízení v nestřežený okamžik.</div>
   <a name="commands-c2s-admin-setpubkey-challenge"></a><h6>Výzva</h6>
   <div>TODO - úvod + popsat, že se nemá ukončovat proud !!!</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_setpubkey_challenge</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_setpubkey_challenge",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "TODO": "TODO"
}
</pre>
   <a name="commands-c2s-admin-setpubkey-response"></a><h6>Odezva</h6>
   <div>TODO - úvod + popsat, že se má pokračovat v proudu !!!</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_setpubkey_response</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_setpubkey_response",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": 0,
 "message": "Public key was changed"
}
</pre>
   <a name="commands-c2s-admin-setpassword"></a><h5>Změna vlastního hesla pro přihlášení</h5>
   <div>Tento příkaz změní přihlašovací heslo uživatele. K tomu, aby mohlo být heslo změněno, je třeba poskytnout přihlašovací výzvu a odezvu, stejně, jako je to u běžného přihlášení a to i v případech, kdy je uživatel již přihlášen. Toto dodatečné přihlášení uvnitř tohoto příkazu je implementováno proto, aby nikdo nemohl neoprávněně změnit heslo na serveru již přihlášenému uživateli, například při použití jeho zařízení v nestřežený okamžik.</div>
   <a name="commands-c2s-admin-setpassword-challenge"></a><h6>Výzva</h6>
   <div>TODO - úvod + popsat, že se nemá ukončovat proud !!!</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_setpassword_challenge</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_setpassword_challenge",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-setpassword-response"></a><h6>Odezva</h6>
   <div>TODO - úvod + popsat, že se má pokračovat v proudu !!!</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_setpassword_response</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_setpassword_response",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-admins"></a><h5>Správci</h5>
   <div>Příkazy v této části dokumentace slouží ke správě správcovských účtů.</div>
   <a name="commands-c2s-admin-admins-list"></a><h6>Seznam správců</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_admins_list</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>admins</td>
      <td>list[Admin] - TODO</td>
      <td class="center">✔</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">-</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_admins_list"
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "admins": [
 {
    "id": 1,
    "name": "admin1",
    "pubkey": "Xxxxx..."
  },
  {
    "id": 2,
    ...
  }
 ]
}
</pre>
   <a name="commands-c2s-admin-admins-add"></a><h6>Přidání nového správce</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_admins_add</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>name</td>
      <td>string</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
     <tr>
      <td>password</td>
      <td>string</td>
      <td class="center">✔❌</td>
      <td>heslo v plaintextu</td>
     </tr>
     <tr>
      <td>pubkey</td>
      <td>string</td>
      <td class="center">✔❌</td>
      <td>veřejný klíč</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>TODO</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_admins_add",
 "name": "admin1",
 "password": "password",
 "pubkey": "Xxxxx..."
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 success: true
}
</pre>
   <a name="commands-c2s-admin-admins-set"></a><h6>Úprava správce</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_admins_edit</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>id</td>
      <td>64-bit integer</td>
      <td class="center">✔</td>
      <td>Správce identifikovaný polem "id"</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>success - TODO</td>
      <td>bool</td>
      <td class="center">✔</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>TODO</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_admins_edit",
 "admin": {
  "id": 1,
  "name": "admin1",
  "pubkey": "Xxxxx..."
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "success": true
}
</pre>
   <a name="commands-c2s-admin-admins-del"></a><h6>Smazání správce</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_admins_del</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>id</td>
      <td>64-bit integer</td>
      <td class="center">✔</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-domains"></a><h5>Domény:</h5>
   <div>TODO - úvod</div>
   <a name="commands-c2s-admin-domains-list"></a><h6>Seznam domén:</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_domains_list</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_domains_list"
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "result": {
  [
   {
    "id": 1,
    "name": "example1.com",
    "created":"2024-04-30 14:51:03"
   }, {
    "id": 2,
    "name": "example2.com",
    "created": "2024-04-30 16:21:08"
   }
  ]
 }
}
</pre>
   <a name="commands-c2s-admin-domains-add"></a><h6>Přidání nové domény</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_domains_add</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-domains-set"></a><h6>Úprava domény</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_domains_edit</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-domains-del"></a><h6>Smazání domény</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_domains_del</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-users"></a><h5>Uživatelské účty</h5>
   <div>TODO - úvod</div>
   <a name="commands-c2s-admin-users-list"></a><h6>Seznam uživatelů</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_users_list</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-users-add"></a><h6>Přidání nového uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_users_add</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-users-set"></a><h6>Úprava uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_users_edit</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-users-del"></a><h6>Smazání uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_users_del</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-users-setpubkey"></a><h6>Změna veřejného klíče pro přihlášení uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_users_setpubkey</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-users-setpassword"></a><h6>Změna hesla pro přihlášení uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_users_setpubkey</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-tokens"></a><h5>Správa uživatelských tokenů relace</h5>
   <div>TODO - úvod</div>
   <a name="commands-c2s-admin-tokens-list"></a><h6>Seznam tokenů relace uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-tokens-set"></a><h6>Úprava tokenu relace uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-tokens-del"></a><h6>Smazání tokenu relace uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-tokens-deluser"></a><h6>Smazání všech tokenů relace uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-tokens-delall"></a><h6>Smazání tokenů relace všech uživatelů</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>



   <a name="commands-c2s-admin-blockusers"></a><h5>Blokace uživatelských účtů</h5>
   <div>TODO - úvod</div>
   <a name="commands-c2s-admin-blockusers-list"></a><h6>Seznam zablokovaných uživatelů</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_blockusers_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_blockusers_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-blockusers-add"></a><h6>Přidání zablokovaného uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_blockusers_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_blockusers_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-blockusers-set"></a><h6>Úprava zablokovaného uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_blockusers_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_blockusers_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-admin-blockusers-del"></a><h6>Smazání zablokovaného uživatele</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_blockusers_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_blockusers_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>

   <a name="commands-c2s-admin-blockip"></a><h5>Blokace IP adres</h5>
   <div>Neautorizované přístupy k serveru mohou být zablokovány a to buď automaticky pomocí ochranných strategií, popsaných v sekci <a href="#security-block">Blokace neautorizovaných přístupů</a> a nebo ručně správcem. Následující příkazy slouží ke správě těchto zablokovaných IP adres.</div>
   <a name="commands-c2s-admin-blockip-list"></a><h6>Seznam zablokovaných IP adres</h6>
   <div>Tento příkaz vrací seznam zablokovaných IP adres.</div>
   <div>Položky zablokovaných IP adres obsahují <span class="bold">ID záznamu</span>, <span class="bold">IP adresu</span>, <span class="bold">ID blokujícího správce</span>, <span class="bold">důvod blokace</span>, <span class="bold">datum zablokování</span> a <span class="bold">dobu trvání blokace ve vteřinách</span>. ID blokujícího správce může být <span class="bold">null</span>, pokud byla IP adresa zablokována automaticky systémem, nikoliv ručně správcem.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_block_list</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>blocked</td>
      <td>array[object]</td>
      <td class="center">✔</td>
      <td>Pole objektů se seznamem zablokovaných IP adres</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">-</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_block_list",
 "params": {
  "offset": 50,
  "count": 4
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": 0,
 "data": {
  "blocked": [
   {
    "id": 51,
    "ip": "10.0.0.123",
    "blocked_by": null,
    "reason": "Too many failed admin login attempts",
    "created": "2024-01-01T00:00:00Z",
    "duration": 86400
   }, {
    "id": 52,
    "ip": "172.16.0.123",
    "blocked_by": null,
    "reason": "Too many failed user login attempts",
    "created": "2024-01-02T00:00:00Z",
    "duration": 86400
   }, {
    "id": 53,
    "ip": "192.168.0.123",
    "blocked_by": null,
    "reason": "Too many failed server sign attempts",
    "created": "2024-01-03T00:00:00Z",
    "duration": 86400
   }, {
    "id": 54,
    "ip": "192.168.0.10",
    "blocked_by": 1,
    "reason": "Spammer",
    "created": "2024-01-04T00:00:00Z",
    "duration": 86400
   }
  ]
 }
}
</pre>
   <a name="commands-c2s-admin-blockip-add"></a><h6>Přidání zablokované IP adresy</h6>
   <div>Tento příkaz přidá na seznam blokovaných IP adres další IP adresu.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_block_add</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>ip</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>IP adresa určená k zablokování</td>
     </tr>
     <tr>
      <td>reason</td>
      <td>string</td>
      <td class="center">❌</td>
      <td>Důvod blokace IP adresy</td>
     </tr>
     <tr>
      <td>duration</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Doba blokace IP adresy ve vteřinách - pokud není vyplněno, je blokace navždy</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>IP address not set</td>
      <td>IP adresa nebyla vyplněna</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>Wrong IP address format</td>
      <td>Formát IP adresy je chybný</td>
     </tr>
     <tr>
      <td class="center">3</td>
      <td>Wrong duration format</td>
      <td>Formát doby trvání blokace je chybný</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_block_add",
 "params": {
  "ip": "10.0.0.123",
  "reason": "Spammer",
  "duration": 86400
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": "0",
 "message": "IP address successfully blocked"
}
</pre>
   <a name="commands-c2s-admin-blockip-set"></a><h6>Úprava zablokované IP adresy</h6>
   <div>Tento příkaz změní parametry položky na seznamu blokovaných IP adres.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_block_edit</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>id</td>
      <td>64-bit integer</td>
      <td class="center">✔</td>
      <td>ID záznamu blokace</td>
     </tr>
     <tr>
      <td>ip</td>
      <td>string</td>
      <td class="center">❌</td>
      <td>IP adresa určená k zablokování - pokud nevyplněno, zůstává původní</td>
     </tr>
     <tr>
      <td>reason</td>
      <td>string</td>
      <td class="center">❌</td>
      <td>Důvod blokace IP adresy - pokud nevyplněno, zůstává původní</td>
     </tr>
     <tr>
      <td>duration</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Doba blokace ve vteřinách - pokud nevyplněno, zůstává původní, pokud = null, je blokace navždy</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>ID of the record is not set</td>
      <td>ID záznamu nebylo vyplněno</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>ID of the record doesn't exist</td>
      <td>ID záznamu neexistuje</td>
     </tr>
     <tr>
      <td class="center">3</td>
      <td>Wrong IP address format</td>
      <td>Formát IP adresy je chybný</td>
     </tr>
     <tr>
      <td class="center">4</td>
      <td>Wrong duration format</td>
      <td>Formát doby trvání blokace je chybný</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_block_edit",
 "params": {
  "id": 1,
  "ip": "10.0.0.123",
  "reason": "Spammer",
  "duration": 86400
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
 {
  "error": "0",
  "message": "IP address block successfully edited"
 }
</pre>
   <a name="commands-c2s-admin-blockip-del"></a><h6>Smazání zablokované IP adresy</h6>
   <div>Tento přžíkaz smaže položku ze seznamu blokovaných IP adres.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_block_del</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>id</td>
      <td>64-bit integer</td>
      <td class="center">✔</td>
      <td>ID záznamu blokace</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>ID of the record is not set</td>
      <td>ID záznamu nebylo vyplněno</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>ID of the record doesn't exist</td>
      <td>ID záznamu neexistuje</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_block_del",
 "params": {
  "id": 123
 }
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "error": 0,
 "message": "IP address successfully removed from the list"
}
</pre>
   <a name="commands-c2s-admin-sysinfo"></a><h5>Informace o serveru pro správce</h5>
   <div>Tento příkaz zobrazuje systémové prostředky serveru.</div>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>admin_info</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold"></div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "admin_info",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "os_name": "Linux",
 "os_version": "5.10.0-19-amd64",
 "cpu_model": "Intel(R) Xeon(R) CPU E5-2673 v4 @ 2.30GHz",
 "cpu_cores": 40,
 "cpu_arch": "x64",
 "cpu_load": 0,
 "ram_total": 8332619776,
 "ram_free": 7842000896,
 "networks": [
  {
   "ens1": [
    "192.168.0.2",
    "12ab::34cd:56ef:7890:1234"
   ]
  }, {
   "ens2": [
    "10.20.30.40",
    "12ab::34cd:56ef:7890:4321"
   ]
  }
 ],
 "uptime": "8 days, 12 hours, 45 minutes, 52 seconds"
}
</pre>
   <a name="commands-c2s-user"></a><h4>Příkazy uživatele</h4>
   <div>Všechny příkazy začínající "<span class="bold">user_</span>" jsou určeny pro uživatele. Aby bylo možné provádět tyto příkazy, musí být uživatel přihlášen (mimo příkazů pro samotné přihlášení). Pokud je přihlášení úspěšné, získá uživatel token relace, kterým se prokazuje při navázání spojení se serverem (místo přihlášení). Přihlášení tokenem je platné po dobu spojení, token se tedy neodesílá v každém uživatelském příkazu.</div>
   <a name="commands-c2s-user-registration"></a><h5>Registrace uživatele</h5>
   <div>Možnost registrace účtu uživatelem musí být povolena na serveru</div>
   <div>TODO - úvod, popsat chybu, kdy není registrace povolena na serveru</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_reg</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>command</td>
      <td>"user_"</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-login"></a><h5>Přihlášení uživatele</h5>
   <div>Přihlášení uživatele probíhá ve dvou krocích - přihlašovací výzvě a přihlašovací odezvě. V přihlašovací výzvě zašle klient své přihlašovací jméno ve tvaru <span class="bold">uživatel@doména</span> a pokud používá mimo privátního klíče i heslo, tak i hash tohoto hesla (nepovinné). Server ověří heslo (pokud uživatel používá) a následně vygeneruje náhodný řetězec, který server zašifruje veřejným klíčem uživatele. Tento zašifrovaný řetězec je následně předán uživateli. Uživatel řetězec rozšifruje pomocí svého soukromého klíče a zašle ho zpět v rámci přihlašovací odezvy. Server ho porovná s původně vygenerovaným řetězcem a v případě, že řetětec od klienta odpovídá původně vygenerovanému, pak uživatele přihlásí a udělí mu token relace. V opačném případě vrátí chybu.</div>
   <a name="commands-c2s-user-login-challenge"></a><h6>Výzva</h6>
   <div>TODO - úvod, připsat upozornění, že nezavírat proud kvůli přihlašovací odezvě</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_login_challenge</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_login_challenge",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-login-response"></a><h6>Odezva</h6>
   <div>TODO - úvod, připsat upozornění, že se navazuje na proud přihlašovací výzvy a po dokončení přihlašovací odezvy se teprve uzavírá proud.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_login_response</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_login_response",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-verify"></a><h5>Ověření uživatele tokenem</h5>
   <div>Pokud byl uživatel již dříve přihlášen, získal token relace a nemusí se tedy přihlašovat, stačí jen aby se místo přihlášení po novém navázání spojení ověřil tokenem relace. Pokud platnost tokenu relace již vypršela, je nutné přihlášení pro získání nového tokenu.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_verify</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>User's token is invalid</td>
      <td>Uživatel poskytl neplatný či prošlý token relace</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-logout"></a><h5>Odhlášení uživatele</h5>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_logout</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-setpubkey"></a><h5>Změna veřejného klíče pro přihlášení</h5>
   <div>TODO - úvod, pozor - vyžaduje ověření původním pubkey (+ heslem, pokud se používá)</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_setpubkey</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-setpassword"></a><h5>Změna hesla pro přihlášení</h5>
   <div>TODO - úvod</div>
   <div>TODO - pozor - vyžaduje ověření původním pubkey (+ heslem, pokud se používalo)</div>
   <div>TODO - toto by mělo umět i nějak zrušit používání hesla pokud to server umožňuje (poslat null?)</div>
   <div>TODO - bude se vyžadovat aktivní příhlášení (tzn. mít token)?</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_setpass</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>command</td>
      <td>"user_"</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-tokens"></a><h5>Správa vlastních tokenů relace</h5>
   <div>TODO - úvod</div>
   <a name="commands-c2s-user-tokens-list"></a><h6>Seznam vlastních tokenů relace</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>user_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-tokens-set"></a><h6>Úprava vlastního tokenu relace</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>user_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-tokens-del"></a><h6>Smazání vlastního tokenu relace</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>user_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>
   <a name="commands-c2s-user-tokens-delall"></a><h6>Smazání všech vlastních tokenů relace</h6>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení správce</th>
     </tr>
     <tr>
      <td>user_tokens_</td>
      <td class="center">✔</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>Název příkazu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_tokens_",
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "-": "-",
}
</pre>


   <a name="commands-c2s-user-info"></a><h5>Informace o serveru pro uživatele</h5>
   <div>Tento příkaz vrací informace o AMTP serveru a nevyžaduje token relace.</div>
   <div>TODO - úvod</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_info</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>TODO</td>
      <td>TODO</td>
      <td class="center">✔❌</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold"></div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_info"
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "app_name": "AMTP Server",
 "app_version": "1.00",
 "hostname": "amtp.example.com"
}
</pre>
   <a name="commands-c2s-user-modules"></a><h5>Seznam používaných modulů</h5>
   <div>Tento příkaz zobrazuje seznam modulů a jejich verzí, které server používá. Server může mít spuštěný jeden modul ve více verzích. To umožňuje zpětnou kompatibilitu se starými verzemi klientských modulů. Tento příkaz nevyžaduje token relace.</div>
   <div class="bold">Struktura požadavku od klienta:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
      <th class="center">Vyžaduje přihlášení uživatele</th>
     </tr>
     <tr>
      <td>user_modules</td>
      <td class="center">❌</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>offset</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počáteční číslo pořadí záznamu ve výpisu. Pokud není parametr vyplněn, pak se začíná od začátku seznamu.</td>
     </tr>
     <tr>
      <td>count</td>
      <td>64-bit integer</td>
      <td class="center">❌</td>
      <td>Počet položek ve výpisu. Pokud není parametr vyplněn, pak jsou vypsány všechny položky.</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>-</td>
      <td>-</td>
      <td class="center">✔❌</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>-</td>
      <td>-</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od klienta:</div>
<pre>
{
 "command": "user_modules"
}
</pre>
   <div class="bold">Příklad odezvy od serveru:</div>
<pre>
{
 "modules": [
  {
   "name": "contacts",
   "version": "1.0"
  }, {
   "name": "messages",
   "version": "1.0"
  }, {
   "name": "messages",
   "version": "2.0"
  }
 ]
}
</pre>
   <a name="commands-s2s"></a><h3>Spojení server-server</h3>
   <div>V této části dokumentace jsou popsány příkazy, které jsou využívány v komunikaci mezi dvěma serverovými aplikacemi:</div>
   <div>TODO: předávání, ověřování protějšího serveru atd.</div>
   <div>TODO: u ověřování protějšího serveru přidat error pokud server nemá spojení s DNS</div>
   
   Spojeni server-server je navazano na zaklade pozadavku modulu na odeslani zpravy na jiny server.
   
   <h4>Navazani spojeni</h4>
   Servery se pri navazani spojeni vzajemne overuji. Toto overeni je provedeno paralelne v obou smerech. Drzeni privatniho klice se overi metodou challenge-response.
   
   Verejny klic serveru se ziska ze tri zdroju:
   1) Z lokalni databaze serveru. 
   2) Z DNS se ziska TXT zaznam ATMP-PUBKEY.
   3) Z odpovedi vzdaleneho serveru v ramci challenge-response flow. 
    
    <h4>Challenge-response flow</h4>

   1) Vzdaleny server je pozadan o podepsani nahodneho retezce. V odpovedi je navic prilozen verejny klic serveru.
   priklad:
    <pre>
    {
      "command": "server_challenge",
      "data": {
        "challenge": "1234567890"
      }
    }
    </pre>

    2) Vzdaleny server odpovi s podpisem a verejnym klicem:
    <pre>
    {
      "command": "server_response",
      "data": {
        "signature": "abcdef1234567890",
        "pubkey": "-----BEGIN..."
      }
    }
    </pre>
    Vsechny verejne klice se porovnaji. V pripade neshody je spojeni ukonceno.
    Podpis ziskany v ramci challenge-response flow se overi pomoci verejneho klice. V pripade neshody je spojeni ukonceno.
   <a name="commands-c2s-modules"></a><h3>Komunikace s moduly</h3>
   <div>Tato část dokumentace popisuje, jakým způsobem se předávají data v rámci modulů mezi <span class="bold">AMTP</span> servery a jakým způsobem komunikuje jádro serveru s moduly.</div>
   <a name="commands-c2s-modules-deliver"></a><h4>Předávání příkazů určených modulům</h4>
   <div>Na vlastním serveru nejprve předá modul zprávu určenou cizímu serveru s následujícími parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th class="center">Vyžadováno</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>to</td>
      <td>string</td>
      <td class="center">✔</td>
      <td>Adresa AMTP serveru, kterému je příkaz určen.</td>
     </tr>
     <tr>
      <td>data</td>
      <td>object</td>
      <td class="center">✔</td>
      <td>Objekt s daty které poskytl modul</td>
     </tr>
    </table>
   </div>
   <div>Jádro serveru do této struktury přidá parametr <span class="bold">module</span> (string), který obsahuje označení názvu modulu.</div>
   <div>Jelikož moduly mohou být vyvinuty různými vývojáři, je potřeba jednoznačný identifikátor názvu modulu. K tomuto účelu se využívá <span class="bold">reverzní zápis názvu domény</span> vývojáře, po kterém následuje tečka <span class="bold">(.)</span>, dále <span class="bold">název modulu</span>, poté podtržítko <span class="bold">(_)</span> a nakonec <span class="bold">verze modulu</span>. Díky identifikaci verze modulu může server poskytovat jeden modul ve více verzích najednou, což se dá využít například pro zpětnou kompatibilitu se staršími verzemi modulů klientských aplikací.</div>
   <div class="bold">Formát názvu modulu:</div>
<pre>
"tld.domain.module-name_version"
</pre>   
   <div class="bold">Příklad názvu modulu:</div>
<pre>
"com.example.messages_1.0"
</pre>
   <div>Tento zápis označuje, že vývojář, který vlastní doménu <span class="bold">example.com</span> vytvořil modul s názvem <span class="bold">messages</span> ve verzi <span class="bold">1.0</span>.</div>
   <div class="bold">Chybové stavy z jádra vlastního serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>Server unavailable</td>
      <td>Protější server neodpovídá</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>TODO</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy z jádra cizího serveru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>Module not found</td>
      <td>Na serveru neběží požadovaný modul</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>TODO</td>
      <td>TODO</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad příkazu od modulu určeného protějšímu serveru:</div>
<pre>
{
 "module": "com.example.messages_1.0",
 "to": "amtp.example2.com",
 "data": {
  "command": "send",
  "params": {
   "from": "alice@example1.com",
   "to": "bob@example2.com",
   "message": "Hi, how are you doing?"
   "created": "2024-01-01T12:00:00Z"
  }
 }
}
</pre>
   <div>V případě, že cílový server příkazu ("to") je místní server, je zpráva předána přímo místnímu modulu, bez odesílání po síti.</div>
   <div>Následně protější server předá modulu strukturu příkazu, ve které přidá parametr <span class="bold">"from"</span>, který obsahuje adresu serveru, který zprávu odeslal a určenému modulu předá strukturu v následujícím tvaru:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>from</td>
      <td>string</td>
      <td>Název serveru, který příkaz zaslal</td>
     </tr>
     <tr>
      <td>data</td>
      <td>object</td>
      <td>Objekt s daty které poskytl modul</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad příkazu určeného ke zpracování modulem:</div>
<pre>
{
 "from": "amtp.example1.com",
 "data": {
  "command": "send",
  "params": {
   "from": "alice@example1.com",
   "to": "bob@example2.com",
   "message": "Hi, how are you doing?"
   "created": "2024-01-01T12:00:00Z"
  }
 }
}
</pre>
   <div>Modul si poté před zpracováním příkazu může ověřit, zda server, který příkaz odeslal, má oprávnění používat v identitách doménová jména. K tomu slouží příkazy <span class="bold">get_servers</span> a <span class="bold">verify_domain</span> mezi moduly a jádrem.</div>
   <a name="commands-c2s-modules-commands"></a><h4>Příkazy mezi jádrem a modulem</h4>
   <div>Následující příkazy poskytují modulům užitečné informace, pomocí kterých si modul může ověřit legitimnost použití identit, které modul protějšího serveru uvedl v objektu <span class="bold">data</span>.</div>
   <a name="commands-c2s-modules-commands-servers"></a><h5>Zjištění oprávněných serverů:</h5>
   <div>Tento příkaz slouží ke zjištění seznamu adres serverů, které mají oprávnění užívat konkrétní doménu.</div>
   <div class="bold">Struktura požadavku od modulu pro jádro:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
     </tr>
     <tr>
      <td>get_servers</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>domain</td>
      <td>string</td>
      <td>Název domény, u které je požadováno zjistit AMTP server(y), které mají oprávnění ji využívat v identitách</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od jádra pro modul:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>servers</td>
      <td>array[string]</td>
      <td>Seznam adres serverů, které mají oprávnění k užívání domény</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>Domain name not set</td>
      <td>Nebyl vyplněn parametr s názvem domény</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>DNS not available</td>
      <td>Nebylo možné se spojit s DNS serverem</td>
     </tr>
     <tr>
      <td class="center">3</td>
      <td>Domain name does not exist</td>
      <td>Doména nebyla nalezena v DNS</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od modulu pro jádro:</div>
<pre>
{
 "command": "get_servers",
 "params": {
  "domain": "example.com"
 }
}
</pre>
   <div class="bold">Příklad odezvy od jádra pro modul:</div>
<pre>
{
 "error": 0,
 "data": {
  "servers": [
   "amtp1.example.com",
   "amtp2.example.com",
   "amtp3.example.com"
  ]
 }
}
</pre>
   <a name="commands-c2s-modules-commands-verify"></a><h5>Ověření opravnění užití domény:</h5>
   <div>Tento příkaz slouží ke zjištění, zda určitý server má oprávnění užívat konkrétní doménu</div>
   <div class="bold">Struktura požadavku od modulu pro jádro:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název příkazu</th>
     </tr>
     <tr>
      <td>verify_domain</td>
     </tr>
    </table>
   </div>
   <div class="bold">Parametry:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>server</td>
      <td>string</td>
      <td>Název serveru u kterého se ověřuje, zda má právo používat identity konkrétní domény</td>
     </tr>
     <tr>
      <td>domain</td>
      <td>string</td>
      <td>Název domény, u které je ověřuje, zda jí má právo používat v identitách konkrétní server</td>
     </tr>
    </table>
   </div>
   <div class="bold">Struktura odezvy od jádra pro modul:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th>Název parametru</th>
      <th>Datový typ</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td>authorized</td>
      <td>bool</td>
      <td>Odpověď, zda server má oprávnění užívat doménu</td>
     </tr>
    </table>
   </div>
   <div class="bold">Chybové stavy:</div>
   <div class="table-container">
    <table class="table-structure">
     <tr>
      <th class="center">Kód chyby</th>
      <th>Zpráva</th>
      <th>Popis</th>
     </tr>
     <tr>
      <td class="center">1</td>
      <td>Domain name not set</td>
      <td>Nebyl vyplněn parametr s názvem domény</td>
     </tr>
     <tr>
      <td class="center">2</td>
      <td>Server address not set</td>
      <td>Nebyl vyplněn parametr s adresou serveru</td>
     </tr>
     <tr>
      <td class="center">3</td>
      <td>DNS not available</td>
      <td>Nebylo možné se spojit s DNS serverem</td>
     </tr>
     <tr>
      <td class="center">4</td>
      <td>Domain name not found</td>
      <td>Doména nebyla nalezena v DNS</td>
     </tr>
     <tr>
      <td class="center">5</td>
      <td>Server address not found</td>
      <td>Adresa serveru nebyla nalezena v DNS</td>
     </tr>
    </table>
   </div>
   <div class="bold">Příklad požadavku od modulu pro jádro:</div>
<pre>
{
 "command": "verify_domain",
 "params": {
  "server": "amtp.example.com",
  "domain": "example.com"
 }
}
</pre>
   <div class="bold">Příklad odezvy od jádra pro modul:</div>
<pre>
{
 "error": 0,
 "data": {
  "authorized": true
 }
}
</pre>
   <a name="examples"></a><h2>Příklady</h2>
   <div>TODO</div>
  </div>
  <div id="resizer" class="no-print"></div>
 </body>
</html>
